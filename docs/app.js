'use strict';

console.log('surfin on sine waves');

var con = new AudioContext();
var out = con.destination;

var A4 = o(f(0));
var Bb4 = o(f(1));
var B4 = o(f(2));
var C4 = o(f(3));
var Db5 = o(f(4));
var D5 = o(f(5));
var Eb5 = o(f(6));
var E5 = o(f(7));
var F5 = o(f(8));
var Gb5 = o(f(9));
var G5 = o(f(10));
var Ab5 = o(f(11));
var A5 = o(f(12));

var oscs = {
  A4: A4,
  Bb4: Bb4,
  B4: B4,
  C4: C4,
  Db5: Db5,
  D5: D5,
  Eb5: Eb5,
  E5: E5,
  F5: F5,
  Gb5: Gb5,
  G5: G5,
  Ab5: Ab5,
  A5: A5
};

var content = document.getElementById('content');

Object.keys(oscs).forEach(function (key) {
  var note = oscs[key];
  var o = note.o;
  var g = note.g;
  o.start();
  g.gain.value = 0;
  makeKey(key);
});

function gain() {
  var g = con.createGain();
  g.connect(out);
  return g;
}

function o(freq) {
  var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'sine';

  var o = con.createOscillator();
  o.type = type;
  o.frequency.value = freq;

  var g = gain();
  o.connect(g);

  return { o: o, g: g };
}

function f(steps) {
  var fixed = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 440;

  return fixed * Math.pow(Math.pow(2, 1 / 12), steps);
}

function n(step) {
  var notes = ['A', 'Bb', 'B', 'C', 'Db', 'D', 'Eb', 'E', 'F', 'Gb', 'G'];
  var note = step % 12;
  return notes[note];
}

function t(tone) {
  var notes = ['A', 'Bb', 'B', 'C', 'Db', 'D', 'Eb', 'E', 'F', 'Gb', 'G'];
  var match = tone.match(/\d/);
  var note = void 0;
  var octave = 0;
  if (match) {
    octave = Number(match[0]);
    note = tone.slice(0, match.index);
  } else {
    note = tone;
  }
  var semi = notes.indexOf(note);
  // const steps = (octave - 4) + semi; TODO Wrong
  return f(semi);
}

function makeKey(key) {
  var ivory = document.createElement('div');
  ivory.id = key;
  ivory.innerHTML = key;
  ivory.dataset.frequency = round(t(key), 3);
  ivory.classList.add('key');
  if (key.match('b')) ivory.classList.add('ebony');
  content.appendChild(ivory);
  ivory.addEventListener('click', toggle);
}

function toggle(event) {
  var key = event.target;
  var on = key.classList.toggle('on');
  if (on) {
    oscs[key.id].g.gain.value = 0.5;
  } else {
    oscs[key.id].g.gain.value = 0;
  }
}

function round(number, precision) {
  var factor = Math.pow(10, precision);
  var tempNumber = number * factor;
  var roundedTempNumber = Math.round(tempNumber);
  return roundedTempNumber / factor;
};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5lczYiXSwibmFtZXMiOlsiY29uc29sZSIsImxvZyIsImNvbiIsIkF1ZGlvQ29udGV4dCIsIm91dCIsImRlc3RpbmF0aW9uIiwiQTQiLCJvIiwiZiIsIkJiNCIsIkI0IiwiQzQiLCJEYjUiLCJENSIsIkViNSIsIkU1IiwiRjUiLCJHYjUiLCJHNSIsIkFiNSIsIkE1Iiwib3NjcyIsImNvbnRlbnQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiT2JqZWN0Iiwia2V5cyIsImZvckVhY2giLCJrZXkiLCJub3RlIiwiZyIsInN0YXJ0IiwiZ2FpbiIsInZhbHVlIiwibWFrZUtleSIsImNyZWF0ZUdhaW4iLCJjb25uZWN0IiwiZnJlcSIsInR5cGUiLCJjcmVhdGVPc2NpbGxhdG9yIiwiZnJlcXVlbmN5Iiwic3RlcHMiLCJmaXhlZCIsIm4iLCJzdGVwIiwibm90ZXMiLCJ0IiwidG9uZSIsIm1hdGNoIiwib2N0YXZlIiwiTnVtYmVyIiwic2xpY2UiLCJpbmRleCIsInNlbWkiLCJpbmRleE9mIiwiaXZvcnkiLCJjcmVhdGVFbGVtZW50IiwiaWQiLCJpbm5lckhUTUwiLCJkYXRhc2V0Iiwicm91bmQiLCJjbGFzc0xpc3QiLCJhZGQiLCJhcHBlbmRDaGlsZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJ0b2dnbGUiLCJldmVudCIsInRhcmdldCIsIm9uIiwibnVtYmVyIiwicHJlY2lzaW9uIiwiZmFjdG9yIiwiTWF0aCIsInBvdyIsInRlbXBOdW1iZXIiLCJyb3VuZGVkVGVtcE51bWJlciJdLCJtYXBwaW5ncyI6Ijs7QUFBQUEsUUFBUUMsR0FBUixDQUFZLHNCQUFaOztBQUVBLElBQU1DLE1BQU0sSUFBSUMsWUFBSixFQUFaO0FBQ0EsSUFBTUMsTUFBTUYsSUFBSUcsV0FBaEI7O0FBRUEsSUFBTUMsS0FBS0MsRUFBRUMsRUFBRSxDQUFGLENBQUYsQ0FBWDtBQUNBLElBQU1DLE1BQU1GLEVBQUVDLEVBQUUsQ0FBRixDQUFGLENBQVo7QUFDQSxJQUFNRSxLQUFLSCxF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QWQsQ0FBcUIsSUFBckIsQ0FBWDtBQUNBLE1BQUlHLEVBQUosRUFBUTtBQUNOL0MsU0FBS08sSUFBSTZCLEVBQVQsRUFBYTNCLENBQWIsQ0FBZUUsSUFBZixDQUFvQkMsS0FBcEIsR0FBNEIsR0FBNUI7QUFDRCxHQUZELE1BRU87QUFDTFosU0FBS08sSUFBSTZCLEVBQVQsRUFBYTNCLENBQWIsQ0FBZUUsSUFBZixDQUFvQkMsS0FBcEIsR0FBNEIsQ0FBNUI7QUFDRDtBQUNGOztBQUVELFNBQVMyQixLQUFULENBQWVTLE1BQWYsRUFBdUJDLFNBQXZCLEVBQWtDO0FBQzlCLE1BQUlDLFNBQVNDLEtBQUtDLEdBQUwsQ0FBUyxFQUFULEVBQWFILFNBQWIsQ0FBYjtBQUNBLE1BQUlJLGFBQWFMLFNBQVNFLE1BQTFCO0FBQ0EsTUFBSUksb0JBQW9CSCxLQUFLWixLQUFMLENBQVdjLFVBQVgsQ0FBeEI7QUFDQSxTQUFPQyxvQkFBb0JKLE1BQTNCO0FBQ0giLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc29sZS5sb2coJ3N1cmZpbiBvbiBzaW5lIHdhdmVzJyk7XG5cbmNvbnN0IGNvbiA9IG5ldyBBdWRpb0NvbnRleHQoKTtcbmNvbnN0IG91dCA9IGNvbi5kZXN0aW5hdGlvbjtcblxuY29uc3QgQTQgPSBvKGYoMCkpO1xuY29uc3QgQmI0ID0gbyhmKDEpKTtcbmNvbnN0IEI0ID0gbyhmKDIpKTtcbmNvbnN0IEM0ID0gbyhmKDMpKTtcbmNvbnN0IERiNSA9IG8oZig0KSk7XG5jb25zdCBENSA9IG8oZig1KSk7XG5jb25zdCBFYjUgPSBvKGYoNikpO1xuY29uc3QgRTUgPSBvKGYoNykpO1xuY29uc3QgRjUgPSBvKGYoOCkpO1xuY29uc3QgR2I1ID0gbyhmKDkpKTtcbmNvbnN0IEc1ID0gbyhmKDEwKSk7XG5jb25zdCBBYjUgPSBvKGYoMTEpKTtcbmNvbnN0IEE1ID0gbyhmKDEyKSk7XG5cbmNvbnN0IG9zY3MgPSB7XG4gIEE0LFxuICBCYjQsXG4gIEI0LFxuICBDNCxcbiAgRGI1LFxuICBENSxcbiAgRWI1LFxuICBFNSxcbiAgRjUsXG4gIEdiNSxcbiAgRzUsXG4gIEFiNSxcbiAgQTUsXG59O1xuXG5jb25zdCBjb250ZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbnRlbnQnKTtcblxuT2JqZWN0LmtleXMob3NjcykuZm9yRWFjaCgoa2V5KSA9PiB7XG4gIGNvbnN0IG5vdGUgPSBvc2NzW2tleV1cbiAgY29uc3QgbyA9IG5vdGUubztcbiAgY29uc3QgZyA9IG5vdGUuZztcbiAgby5zdGFydCgpO1xuICBnLmdhaW4udmFsdWUgPSAwO1xuICBtYWtlS2V5KGtleSk7XG5cbn0pO1xuXG5mdW5jdGlvbiBnYWluKCkge1xuICAgIGNvbnN0IGcgPSBjb24uY3JlYXRlR2FpbigpO1xuICAgIGcuY29ubmVjdChvdXQpO1xuICAgIHJldHVybiBnO1xufVxuXG5mdW5jdGlvbiBvKGZyZXEsIHR5cGUgPSAnc2luZScpIHtcbiAgICBjb25zdCBvID0gY29uLmNyZWF0ZU9zY2lsbGF0b3IoKTtcbiAgICBvLnR5cGUgPSB0eXBlO1xuICAgIG8uZnJlcXVlbmN5LnZhbHVlID0gZnJlcTtcblxuICAgIGNvbnN0IGcgPSBnYWluKCk7XG4gICAgby5jb25uZWN0KGcpO1xuXG4gICAgcmV0dXJuIHtvLCBnfTtcbn1cblxuZnVuY3Rpb24gZihzdGVwcywgZml4ZWQgPSA0NDApIHtcbiAgcmV0dXJuIGZpeGVkICogKDIgKiogKDEvMTIpKSAqKiBzdGVwc1xufVxuXG5mdW5jdGlvbiBuKHN0ZXApIHtcbiAgY29uc3Qgbm90ZXMgPSBbICdBJywgJ0JiJywgJ0InLCAnQycsICdEYicsICdEJywgJ0ViJywgJ0UnLCAnRicsICdHYicsICdHJ107XG4gIGNvbnN0IG5vdGUgPSBzdGVwICUgMTJcbiAgcmV0dXJuIG5vdGVzW25vdGVdO1xufVxuXG5mdW5jdGlvbiB0KHRvbmUpIHtcbiAgY29uc3Qgbm90ZXMgPSBbICdBJywgJ0JiJywgJ0InLCAnQycsICdEYicsICdEJywgJ0ViJywgJ0UnLCAnRicsICdHYicsICdHJ107XG4gIGNvbnN0IG1hdGNoID0gdG9uZS5tYXRjaCgvXFxkLyk7XG4gIGxldCBub3RlO1xuICBsZXQgb2N0YXZlID0gMDtcbiAgaWYgKG1hdGNoKSB7XG4gICAgb2N0YXZlID0gTnVtYmVyKG1hdGNoWzBdKTtcbiAgICBub3RlID0gdG9uZS5zbGljZSgwLCBtYXRjaC5pbmRleCk7XG4gIH0gZWxzZSB7XG4gICAgbm90ZSA9IHRvbmU7XG4gIH1cbiAgY29uc3Qgc2VtaSA9IG5vdGVzLmluZGV4T2Yobm90ZSk7XG4gIC8vIGNvbnN0IHN0ZXBzID0gKG9jdGF2ZSAtIDQpICsgc2VtaTsgVE9ETyBXcm9uZ1xuICByZXR1cm4gZihzZW1pKTtcbn1cblxuZnVuY3Rpb24gbWFrZUtleShrZXkpIHtcbiAgY29uc3QgaXZvcnkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgaXZvcnkuaWQgPSBrZXk7XG4gIGl2b3J5LmlubmVySFRNTCA9IGtleTtcbiAgaXZvcnkuZGF0YXNldC5mcmVxdWVuY3kgPSByb3VuZCh0KGtleSksIDMpO1xuICBpdm9yeS5jbGFzc0xpc3QuYWRkKCdrZXknKTtcbiAgaWYgKGtleS5tYXRjaCgnYicpKSBpdm9yeS5jbGFzc0xpc3QuYWRkKCdlYm9ueScpO1xuICBjb250ZW50LmFwcGVuZENoaWxkKGl2b3J5KTtcbiAgaXZvcnkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0b2dnbGUpO1xufVxuXG5mdW5jdGlvbiB0b2dnbGUoZXZlbnQpIHtcbiAgY29uc3Qga2V5ID0gZXZlbnQudGFyZ2V0O1xuICBjb25zdCBvbiA9IGtleS5jbGFzc0xpc3QudG9nZ2xlKCdvbicpO1xuICBpZiAob24pIHsgXG4gICAgb3Njc1trZXkuaWRdLmcuZ2Fpbi52YWx1ZSA9IDAuNTtcbiAgfSBlbHNlIHtcbiAgICBvc2NzW2tleS5pZF0uZy5nYWluLnZhbHVlID0gMDtcbiAgfVxufVxuXG5mdW5jdGlvbiByb3VuZChudW1iZXIsIHByZWNpc2lvbikge1xuICAgIHZhciBmYWN0b3IgPSBNYXRoLnBvdygxMCwgcHJlY2lzaW9uKTtcbiAgICB2YXIgdGVtcE51bWJlciA9IG51bWJlciAqIGZhY3RvcjtcbiAgICB2YXIgcm91bmRlZFRlbXBOdW1iZXIgPSBNYXRoLnJvdW5kKHRlbXBOdW1iZXIpO1xuICAgIHJldHVybiByb3VuZGVkVGVtcE51bWJlciAvIGZhY3Rvcjtcbn07XG4iXX0=
